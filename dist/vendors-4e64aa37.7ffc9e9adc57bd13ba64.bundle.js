"use strict";(self.webpackChunkaurelia_app=self.webpackChunkaurelia_app||[]).push([[566],{378:(t,e,r)=>{var n,i,o,a,u,s,c,f,l=r(15),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};if("undefined"==typeof FEATURE_NO_ES2015&&(function(t,e){if(!(e in t)){var r,n=l.iw.global,i=0,o=""+Math.random(),a="__symbol:",u=a.length,s="__symbol@@"+o,c="defineProperty",f="defineProperties",p="getOwnPropertyNames",v="getOwnPropertyDescriptor",d="propertyIsEnumerable",g=t[p],y=t[v],m=t.create,b=t.keys,w=t[c],_=t[f],P=y(t,p),S=t.prototype,R=S.hasOwnProperty,I=S[d],A=S.toString,O=(Array.prototype.indexOf,function(t,e,r){R.call(t,s)||w(t,s,{enumerable:!1,configurable:!1,writable:!1,value:{}}),t[s]["@@"+e]=r}),N=function(t,e){var r=m(t);return null!==e&&"object"===(void 0===e?"undefined":h(e))&&g(e).forEach((function(t){k.call(e,t)&&F(r,t,e[t])})),r},E=function(){},C=function(t){return t!=s&&!R.call(T,t)},j=function(t){return t!=s&&R.call(T,t)},k=function(t){var e=""+t;return j(e)?R.call(this,e)&&this[s]&&this[s]["@@"+e]:I.call(this,t)},x=function(e){return w(S,e,{enumerable:!1,configurable:!0,get:E,set:function(t){r(this,e,{enumerable:!1,configurable:!0,writable:!0,value:t}),O(this,e,!0)}}),T[e]=w(t(e),"constructor",q)},M=function(t){if(this&&this!==n)throw new TypeError("Symbol is not a constructor");return x(a.concat(t||"",o,++i))},T=m(null),q={value:M},U=function(t){return T[t]},F=function(t,e,n){var i=""+e;return j(i)?(r(t,i,n.enumerable?function(t){var e=m(t);return e.enumerable=!1,e}(n):n),O(t,i,!!n.enumerable)):w(t,e,n),t},z=function(e){return e="[object String]"===A.call(e)?e.split(""):t(e),g(e).filter(j).map(U)};P.value=F,w(t,c,P),P.value=z,w(t,e,P);var W="object"===("undefined"==typeof window?"undefined":h(window))?t.getOwnPropertyNames(window):[],D=t.getOwnPropertyNames;P.value=function(t){if("[object Window]"===A.call(t))try{return D(t)}catch(t){return[].concat([],W)}return g(t).filter(C)},w(t,p,P),P.value=function(t,e){var r=z(e);return r.length?b(e).concat(r).forEach((function(r){k.call(e,r)&&F(t,r,e[r])})):_(t,e),t},w(t,f,P),P.value=k,w(S,d,P),P.value=M,w(n,"Symbol",P),P.value=function(t){var e=a.concat(a,t,o);return e in S?T[e]:x(e)},w(M,"for",P),P.value=function(t){return R.call(T,t)?t.slice(2*u,-o.length):void 0},w(M,"keyFor",P),P.value=function(t,e){var r=y(t,e);return r&&j(e)&&(r.enumerable=k.call(t,e)),r},w(t,v,P),P.value=function(t,e){return 1===arguments.length?m(t):N(t,e)},w(t,"create",P),P.value=function(){var t=A.call(this);return"[object String]"===t&&j(this)?"[object Symbol]":t},w(S,"toString",P);try{r=m(w({},a,{get:function(){return w(this,a,{value:!1})[a]}}))[a]||w}catch(t){r=function(t,e,r){var n=y(S,e);delete S[e],w(t,e,r),w(S,e,n)}}}}(Object,"getOwnPropertySymbols"),n=Object,Symbol,o=n.defineProperty,a=n.prototype,u=a.toString,["iterator","match","replace","search","split","hasInstance","isConcatSpreadable","unscopables","species","toPrimitive",s="toStringTag"].forEach((function(t){t in Symbol||(o(Symbol,t,{value:Symbol(t)}),t!==s)||((i=n.getOwnPropertyDescriptor(a,"toString")).value=function(){var t=u.call(this),e=null==this?void 0:this[Symbol.toStringTag];return void 0===e?t:"[object "+e+"]"},o(a,"toString",i))})),function(t,e,r){function n(){return this}e[t]||(e[t]=function(){var e=0,r=this,i={next:function(){var t=r.length<=e;return t?{done:t}:{done:t,value:r[e++]}}};return i[t]=n,i}),r[t]||(r[t]=function(){var e=String.fromCodePoint,r=this,i=0,o=r.length,a={next:function(){var t=o<=i,n=t?"":e(r.codePointAt(i));return i+=n.length,t?{done:t}:{done:t,value:n}}};return a[t]=n,a})}(Symbol.iterator,Array.prototype,String.prototype)),"undefined"==typeof FEATURE_NO_ES2015&&(Number.isNaN=Number.isNaN||function(t){return t!=t},Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)}),String.prototype.endsWith&&!function(){try{return!"ab".endsWith("a",1)}catch(t){return!0}}()||(String.prototype.endsWith=function(t,e){var r=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>r.length)&&(e=r.length),e-=t.length;var n=r.indexOf(t,e);return-1!==n&&n===e}),String.prototype.startsWith&&!function(){try{return!"ab".startsWith("b",1)}catch(t){return!0}}()||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),"undefined"==typeof FEATURE_NO_ES2015&&(Array.from||(Array.from=(c=function(t){return t>0?Math.min(function(t){return isNaN(t=+t)?0:(t>0?Math.floor:Math.ceil)(t)}(t),9007199254740991):0},f=function(t,e,r,n){try{return e(r,n)}catch(e){throw"function"==typeof t.return&&t.return(),e}},function(t){var e,r,n,i,o=Object(t),a="function"==typeof this?this:Array,u=arguments.length,s=u>1?arguments[1]:void 0,l=void 0!==s,h=0,p=o[Symbol.iterator];if(l&&(s=s.bind(u>2?arguments[2]:void 0)),null==p||Array.isArray(t))for(r=new a(e=c(o.length));e>h;h++)r[h]=l?s(o[h],h):o[h];else for(i=p.call(o),r=new a;!(n=i.next()).done;h++)r[h]=l?f(i,s,n.value,h):n.value;return r.length=h,r})),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,enumerable:!1,value:function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,r=Object(this),n=r.length>>>0,i=arguments[1],o=0;o<n;o++)if(e=r[o],t.call(i,e,o,r))return e}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{configurable:!0,writable:!0,enumerable:!1,value:function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,r=Object(this),n=r.length>>>0,i=arguments[1],o=0;o<n;o++)if(e=r[o],t.call(i,e,o,r))return o;return-1}})),"undefined"!=typeof FEATURE_NO_ES2016||Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,enumerable:!1,value:function(t){var e=Object(this),r=parseInt(e.length)||0;if(0===r)return!1;var n,i,o=parseInt(arguments[1])||0;for(o>=0?n=o:(n=r+o)<0&&(n=0);n<r;){if(t===(i=e[n])||t!=t&&i!=i)return!0;n++}return!1}}),"undefined"==typeof FEATURE_NO_ES2015&&(function(){var t,e,r,n,i=!1;try{var o=Object.keys("a");i=1!==o.length||"0"!==o[0]}catch(t){i=!0}i&&(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if(null==i)throw TypeError("Cannot convert undefined or null to object");i=Object(i);var o,a,u=[];for(o in i)t.call(i,o)&&u.push(o);if(e)for(a=0;a<n;a++)t.call(i,r[a])&&u.push(r[a]);return u}))}(),function(t){var e,r,n;"assign"in t||t.defineProperty(t,"assign",{configurable:!0,writable:!0,value:(e=t.getOwnPropertySymbols,r=t.propertyIsEnumerable,n=e?function(t){return e(t).filter(r,t)}:function(){return Array.prototype},function(r){function i(t){r[t]=u[t]}!e||r instanceof t||console.warn("problematic Symbols",r);for(var o=1,a=arguments.length;o<a;++o){var u=arguments[o];null!=u&&t.keys(u).concat(n(u)).forEach(i)}return r})})}(Object),Object.is||(Object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e})),"undefined"==typeof FEATURE_NO_ES2015&&function(t){var e,r,n,i=Object.defineProperty;function o(t,e){function r(t){if(!this||this.constructor!==r)return new r(t);this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,t&&a.call(this,t)}return e||i(t,"size",{get:m}),t.constructor=r,r.prototype=t,r}function a(t){this.add?t.forEach(this.add,this):t.forEach((function(t){this.set(t[0],t[1])}),this)}function u(t){return this.has(t)&&(this._keys.splice(e,1),this._values.splice(e,1),this._itp.forEach((function(t){e<t[0]&&t[0]--}))),-1<e}function s(t){return this.has(t)?this._values[e]:void 0}function c(t,r){if(this.objectOnly&&r!==Object(r))throw new TypeError("Invalid value used as weak collection key");if(r!=r||0===r)for(e=t.length;e--&&(n=t[e])!==(i=r)&&(n==n||i==i););else e=t.indexOf(r);var n,i;return-1<e}function f(t){return c.call(this,this._values,t)}function l(t){return c.call(this,this._keys,t)}function h(t,r){return this.has(t)?this._values[e]=r:this._values[this._keys.push(t)-1]=r,this}function p(t){return this.has(t)||this._values.push(t),this}function v(){(this._keys||0).length=this._values.length=0}function d(){return y(this._itp,this._values)}function g(){return y(this._itp,this._keys,this._values)}function y(t,e,r){var n,i=[0],o=!1;return t.push(i),(n={})[Symbol.iterator]=function(){return this},n.next=function(){var n,a=i[0];return!o&&a<e.length?(n=r?[e[a],r[a]]:e[a],i[0]++):(o=!0,t.splice(t.indexOf(i),1)),{done:o,value:n}},n}function m(){return this._values.length}function b(t,e){for(var r=this.entries();;){var n=r.next();if(n.done)break;t.call(e,n.value[1],n.value[0],this)}}"undefined"==typeof WeakMap&&(t.WeakMap=o({delete:u,clear:v,get:s,has:l,set:h},!0)),"undefined"!=typeof Map&&"function"==typeof(new Map).values&&(new Map).values().next||(t.Map=o(((r={delete:u,has:l,get:s,set:h,keys:function(){return y(this._itp,this._keys)},values:d,entries:g,forEach:b,clear:v})[Symbol.iterator]=g,r))),"undefined"!=typeof Set&&"function"==typeof(new Set).values&&(new Set).values().next||(t.Set=o(((n={has:f,add:p,delete:u,clear:v,keys:d,values:d,entries:function(){return y(this._itp,this._values,this._values)},forEach:b})[Symbol.iterator]=d,n))),"undefined"==typeof WeakSet&&(t.WeakSet=o({delete:u,add:p,clear:v,has:f},!0))}(l.iw.global),"undefined"==typeof FEATURE_NO_ES2015){var p=Function.prototype.bind;void 0===l.iw.global.Reflect&&(l.iw.global.Reflect={}),"function"!=typeof Reflect.defineProperty&&(Reflect.defineProperty=function(t,e,r){if("object"===(void 0===t?"undefined":h(t))?null===t:"function"!=typeof t)throw new TypeError("Reflect.defineProperty called on non-object");try{return Object.defineProperty(t,e,r),!0}catch(t){return!1}}),"function"!=typeof Reflect.construct&&(Reflect.construct=function(t,e){if(e)switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(p.apply(t,r))}),"function"!=typeof Reflect.ownKeys&&(Reflect.ownKeys=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))})}if("undefined"==typeof FEATURE_NO_ESNEXT){var v=Object.freeze({}),d="__metadata__";"function"!=typeof Reflect.getOwnMetadata&&(Reflect.getOwnMetadata=function(t,e,r){if(e.hasOwnProperty(d))return(e.__metadata__[r]||v)[t]}),"function"!=typeof Reflect.defineMetadata&&(Reflect.defineMetadata=function(t,e,r,n){var i=r.hasOwnProperty(d)?r.__metadata__:r.__metadata__={};(i[n]||(i[n]={}))[t]=e}),"function"!=typeof Reflect.metadata&&(Reflect.metadata=function(t,e){return function(r,n){Reflect.defineMetadata(t,e,r,n)}})}},470:(t,e,r)=>{r.d(e,{WY:()=>yt,b8:()=>J,F0:()=>N});var n=r(99),i=r(158),o=r(149),a=r(627),u=function(){function t(t){this.charSpec=t,this.nextStates=[]}return t.prototype.get=function(t){var e=this.nextStates,r=Array.isArray(e),n=0;for(e=r?e:e[Symbol.iterator]();;){var i;if(r){if(n>=e.length)break;i=e[n++]}else{if((n=e.next()).done)break;i=n.value}var o=i;if(o.charSpec.validChars===t.validChars&&o.charSpec.invalidChars===t.invalidChars)return o}},t.prototype.put=function(e){var r=this.get(e);return r||(r=new t(e),this.nextStates.push(r),e.repeat&&r.nextStates.push(r),r)},t.prototype.match=function(t){for(var e=this.nextStates,r=[],n=0,i=e.length;n<i;n++){var o=e[n],a=o.charSpec;void 0!==a.validChars?-1!==a.validChars.indexOf(t)&&r.push(o):void 0!==a.invalidChars&&-1===a.invalidChars.indexOf(t)&&r.push(o)}return r},t}(),s=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),c=function(){function t(t,e){this.string=t,this.caseSensitive=e}return t.prototype.eachChar=function(t){for(var e=this.string,r=0,n=e.length;r<n;++r){var i=e[r];t({validChars:this.caseSensitive?i:i.toUpperCase()+i.toLowerCase()})}},t.prototype.regex=function(){return this.string.replace(s,"\\$1")},t.prototype.generate=function(){return this.string},t}(),f=function(){function t(t,e){this.name=t,this.optional=e}return t.prototype.eachChar=function(t){t({invalidChars:"/",repeat:!0})},t.prototype.regex=function(){return"([^/]+)"},t.prototype.generate=function(t,e){return e[this.name]=!0,t[this.name]},t}(),l=function(){function t(t){this.name=t}return t.prototype.eachChar=function(t){t({invalidChars:"",repeat:!0})},t.prototype.regex=function(){return"(.+)"},t.prototype.generate=function(t,e){return e[this.name]=!0,t[this.name]},t}(),h=function(){function t(){}return t.prototype.eachChar=function(){},t.prototype.regex=function(){return""},t.prototype.generate=function(){return""},t}(),p=function(){function t(){this.rootState=new u,this.names={},this.routes=new Map}return t.prototype.add=function(t){var e=this;if(!Array.isArray(t)){for(var r=this.rootState,n=[],i="^",o={statics:0,dynamics:0,stars:0},a=[],u=t.handler.name,s=!0,p=function(t,e,r,n){var i=t;"/"===t.charAt(0)&&(i=t.substr(1));for(var o=[],a=i.split("/"),u=0,s=a.length;u<s;++u){var p=a[u],v=p.match(/^:([^?]+)(\?)?$/);if(v){var d=v,g=d[1],y=d[2];if(-1!==g.indexOf("="))throw new Error("Parameter "+g+" in route "+t+" has a default value, which is not supported.");o.push(new f(g,!!y)),e.push(g),r.dynamics++}else(v=p.match(/^\*(.+)$/))?(o.push(new l(v[1])),e.push(v[1]),r.stars++):""===p?o.push(new h):(o.push(new c(p,n)),r.statics++)}return o}(t.path,a,o,t.caseSensitive),v=0,d=p.length;v<d;v++){var y=p[v];if(!(y instanceof h)){for(var m=g(r,y),b=m[0],w=m[1],_=0,P=n.length;_<P;_++)n[_].nextStates.push(b);y.optional?(n.push(w),i+="(?:/"+y.regex()+")?"):(r=w,i+="/"+y.regex(),n.length=0,s=!1)}}s&&(r=r.put({validChars:"/"}),i+="/?");var S=[{handler:t.handler,names:a}];if(this.routes.set(t.handler,{segments:p,handlers:S}),u)for(var R=Array.isArray(u)?u:[u],I=0;I<R.length;I++)R[I]in this.names||(this.names[R[I]]={segments:p,handlers:S});for(var A=0;A<n.length;A++){var O=n[A];O.handlers=S,O.regex=new RegExp(i+"$",t.caseSensitive?"":"i"),O.types=o}return r.handlers=S,r.regex=new RegExp(i+"$",t.caseSensitive?"":"i"),r.types=o,r}t.forEach((function(t){return e.add(t)}))},t.prototype.getRoute=function(t){return"string"==typeof t?this.names[t]:this.routes.get(t)},t.prototype.handlersFor=function(t){var e=this.getRoute(t);if(!e)throw new Error("There is no route named "+t);return[].concat(e.handlers)},t.prototype.hasRoute=function(t){return!!this.getRoute(t)},t.prototype.generate=function(t,e){var r=this.getRoute(t);if(!r)throw new Error("There is no route named "+t);var n=r.handlers[0].handler;if(n.generationUsesHref)return n.href;for(var i=Object.assign({},e),o=r.segments,u={},s="",c=0,f=o.length;c<f;c++){var l=o[c];if(!(l instanceof h)){var p=l.generate(i,u);if(null==p){if(!l.optional)throw new Error("A value is required for route parameter '"+l.name+"' in route '"+t+"'.")}else s+="/",s+=p}}for(var v in"/"!==s.charAt(0)&&(s="/"+s),u)delete i[v];var d=(0,a.Ie)(i);return s+(d?"?"+d:"")},t.prototype.recognize=function(t){var e=[this.rootState],r={},n=!1,i=t,o=i.indexOf("?");if(-1!==o){var u=i.substr(o+1,i.length);i=i.substr(0,o),r=(0,a.dD)(u)}"/"!==(i=decodeURI(i)).charAt(0)&&(i="/"+i);var s=i.length;s>1&&"/"===i.charAt(s-1)&&(i=i.substr(0,s-1),n=!0);for(var c=0,f=i.length;c<f&&(e=d(e,i.charAt(c))).length;c++);for(var l=[],h=0,p=e.length;h<p;h++)e[h].handlers&&l.push(e[h]);e=function(t){return t.sort((function(t,e){if(t.types.stars!==e.types.stars)return t.types.stars-e.types.stars;if(t.types.stars){if(t.types.statics!==e.types.statics)return e.types.statics-t.types.statics;if(t.types.dynamics!==e.types.dynamics)return e.types.dynamics-t.types.dynamics}return t.types.dynamics!==e.types.dynamics?t.types.dynamics-e.types.dynamics:t.types.statics!==e.types.statics?e.types.statics-t.types.statics:0}))}(l);var g=l[0];if(g&&g.handlers)return n&&"(.+)$"===g.regex.source.slice(-5)&&(i+="/"),function(t,e,r){for(var n=t.handlers,i=t.regex,o=e.match(i),a=1,u=new v(r),s=0,c=n.length;s<c;s++){for(var f=n[s],l=f.names,h={},p=0,d=l.length;p<d;p++)h[l[p]]=o[a++];u.push({handler:f.handler,params:h,isDynamic:!!l.length})}return u}(g,i,r)},t}(),v=function(t){this.splice=Array.prototype.splice,this.slice=Array.prototype.slice,this.push=Array.prototype.push,this.length=0,this.queryParams=t||{}};function d(t,e){for(var r=[],n=0,i=t.length;n<i;n++){var o=t[n];r.push.apply(r,o.match(e))}return r}function g(t,e){var r=t.put({validChars:"/"}),n=r;return e.eachChar((function(t){n=n.put(t)})),[r,n]}var y=r("aurelia-event-aggregator"),m=function(t,e){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},m(t,e)},b=function(){function t(t){this.plan=null,this.options={},Object.assign(this,t),this.params=this.params||{},this.viewPortInstructions={};var e=[],r=this;do{var n=Object.assign({},r.params);r.config&&r.config.hasChildRouter&&delete n[r.getWildCardName()],e.unshift(n),r=r.parentInstruction}while(r);var i=Object.assign.apply(Object,[{},this.queryParams].concat(e));this.lifecycleArgs=[i,this.config,this]}return t.prototype.getAllInstructions=function(){var t=[this],e=this.viewPortInstructions;for(var r in e){var n=e[r].childNavigationInstruction;n&&t.push.apply(t,n.getAllInstructions())}return t},t.prototype.getAllPreviousInstructions=function(){return this.getAllInstructions().map((function(t){return t.previousInstruction})).filter((function(t){return t}))},t.prototype.addViewPortInstruction=function(t,e,r,n){var i,o="string"==typeof t?t:t.name,a=this.lifecycleArgs,u=Object.assign({},a[1],{currentViewPort:o});return i="string"==typeof t?{name:t,strategy:e,moduleId:r,component:n,childRouter:n.childRouter,lifecycleArgs:[a[0],u,a[2]]}:{name:o,strategy:t.strategy,component:t.component,moduleId:t.moduleId,childRouter:t.component.childRouter,lifecycleArgs:[a[0],u,a[2]]},this.viewPortInstructions[o]=i},t.prototype.getWildCardName=function(){var t=this.config.route,e=t.lastIndexOf("*");return t.substr(e+1)},t.prototype.getWildcardPath=function(){var t=this.getWildCardName(),e=this.params[t]||"",r=this.queryString;return r&&(e+="?"+r),e},t.prototype.getBaseUrl=function(){var t=this,e=encodeURI,r=decodeURI(this.fragment);if(""===r){var n=this.router.routes.find((function(e){return e.name===t.config.name&&""!==e.route}));n&&(r=n.route)}if(!this.params)return e(r);var i=this.getWildCardName(),o=this.params[i]||"";return e(o?r.substr(0,r.lastIndexOf(o)):r)},t.prototype._commitChanges=function(t){var e=this,r=this.router;r.currentInstruction=this;var n=this.previousInstruction;n&&(n.config.navModel.isActive=!1),this.config.navModel.isActive=!0,r.refreshNavigation();var i=[],o=[],a=this.viewPortInstructions,u=function(e){var n=a[e],u=r.viewPorts[e];if(!u)throw new Error("There was no router-view found in the view for "+n.moduleId+".");var s=n.childNavigationInstruction;"replace"===n.strategy?s&&s.parentCatchHandler?i.push(s._commitChanges(t)):(t&&o.push({viewPort:u,viewPortInstruction:n}),i.push(u.process(n,t).then((function(){return s?s._commitChanges(t):Promise.resolve()})))):s&&i.push(s._commitChanges(t))};for(var s in a)u(s);return Promise.all(i).then((function(){return o.forEach((function(t){return t.viewPort.swap(t.viewPortInstruction)})),null})).then((function(){return w(e)}))},t.prototype._updateTitle=function(){var t=this.router,e=this._buildTitle(t.titleSeparator);e&&t.history.setTitle(e)},t.prototype._buildTitle=function(t){void 0===t&&(t=" | ");var e="",r=[],n=this.config.navModel.title,i=this.router,o=this.viewPortInstructions;for(var a in n&&(e=i.transformTitle(n)),o){var u=o[a].childNavigationInstruction;if(u){var s=u._buildTitle(t);s&&r.push(s)}}return r.length&&(e=r.join(t)+(e?t:"")+e),i.title&&(e+=(e?t:"")+i.transformTitle(i.title)),e},t}(),w=function(t){t.previousInstruction=null,t.plan=null},_=function(){function t(t,e){this.isActive=!1,this.title=null,this.href=null,this.relativeHref=null,this.settings={},this.config=null,this.router=t,this.relativeHref=e}return t.prototype.setTitle=function(t){this.title=t,this.isActive&&this.router.updateTitle()},t}();function P(t,e,r){return void 0===r&&(r=!1),e||"#"===t[0]||(t="#"+t),e&&r&&(t=t.substring(1,t.length)),t}function S(t,e,r,n){if(A.test(t))return t;var i="";return e.length&&"/"!==e[0]&&(i+="/"),(i+=e).length&&"/"===i[i.length-1]||"/"===t[0]||(i+="/"),i.length&&"/"===i[i.length-1]&&"/"===t[0]&&(i=i.substring(0,i.length-1)),P(i+t,r,n)}function R(t){var e=[];if(Array.isArray(t.route))for(var r=0,n=t.route.length;r<n;++r){var i=Object.assign({},t);i.route=t.route[r],e.push(i)}else e.push(Object.assign({},t));return e}var I=/^#?\//,A=/^([a-z][a-z0-9+\-.]*:)?\/\//i,O=function(){function t(){this.instructions=[],this.options={},this.pipelineSteps=[]}return t.prototype.addPipelineStep=function(t,e){if(null==e)throw new Error("Pipeline step cannot be null or undefined.");return this.pipelineSteps.push({name:t,step:e}),this},t.prototype.addAuthorizeStep=function(t){return this.addPipelineStep("authorize",t)},t.prototype.addPreActivateStep=function(t){return this.addPipelineStep("preActivate",t)},t.prototype.addPreRenderStep=function(t){return this.addPipelineStep("preRender",t)},t.prototype.addPostRenderStep=function(t){return this.addPipelineStep("postRender",t)},t.prototype.fallbackRoute=function(t){return this._fallbackRoute=t,this},t.prototype.map=function(t){var e=this;return Array.isArray(t)?(t.forEach((function(t){return e.map(t)})),this):this.mapRoute(t)},t.prototype.useViewPortDefaults=function(t){return this.viewPortDefaults=t,this},t.prototype.mapRoute=function(t){return this.instructions.push((function(e){for(var r,n=R(t),i=0,o=n.length;i<o;++i){var a=n[i];a.settings=a.settings||{},r||(r=e.createNavModel(a)),e.addRoute(a,r)}})),this},t.prototype.mapUnknownRoutes=function(t){return this.unknownRouteConfig=t,this},t.prototype.exportToRouter=function(t){for(var e=this.instructions,r=0,n=e.length;r<n;++r)e[r](t);var i=this,o=i.title,a=i.titleSeparator,u=i.unknownRouteConfig,s=i._fallbackRoute,c=i.viewPortDefaults;o&&(t.title=o),a&&(t.titleSeparator=a),u&&t.handleUnknownRoutes(u),s&&(t.fallbackRoute=s),c&&t.useViewPortDefaults(c),Object.assign(t.options,this.options);var f=this.pipelineSteps,l=f.length;if(l){if(!t.isRoot)throw new Error("Pipeline steps can only be added to the root router");var h=t.pipelineProvider;for(r=0,n=l;r<n;++r){var p=f[r],v=p.name,d=p.step;h.addStep(v,d)}}},t}(),N=function(){function t(t,e){var r=this;this.parent=null,this.options={},this.viewPortDefaults={},this.transformTitle=function(t){return r.parent?r.parent.transformTitle(t):t},this.container=t,this.history=e,this.reset()}return t.prototype.reset=function(){var t=this;this.viewPorts={},this.routes=[],this.baseUrl="",this.isConfigured=!1,this.isNavigating=!1,this.isExplicitNavigation=!1,this.isExplicitNavigationBack=!1,this.isNavigatingFirst=!1,this.isNavigatingNew=!1,this.isNavigatingRefresh=!1,this.isNavigatingForward=!1,this.isNavigatingBack=!1,this.couldDeactivate=!1,this.navigation=[],this.currentInstruction=null,this.viewPortDefaults={},this._fallbackOrder=100,this._recognizer=new p,this._childRecognizer=new p,this._configuredPromise=new Promise((function(e){t._resolveConfiguredPromise=e}))},Object.defineProperty(t.prototype,"isRoot",{get:function(){return!this.parent},enumerable:!0,configurable:!0}),t.prototype.registerViewPort=function(t,e){e=e||"default",this.viewPorts[e]=t},t.prototype.ensureConfigured=function(){return this._configuredPromise},t.prototype.configure=function(t){var e=this;this.isConfigured=!0;var r,n=t;return"function"==typeof t&&(n=t(r=new O)),Promise.resolve(n).then((function(t){t&&t.exportToRouter&&(r=t),r.exportToRouter(e),e.isConfigured=!0,e._resolveConfiguredPromise()}))},t.prototype.navigate=function(t,e){return!this.isConfigured&&this.parent?this.parent.navigate(t,e):(this.isExplicitNavigation=!0,this.history.navigate(function(t,e,r){return I.test(t)?P(t,r):S(t,e,r)}(t,this.baseUrl,this.history._hasPushState),e))},t.prototype.navigateToRoute=function(t,e,r){var n=this.generate(t,e);return this.navigate(n,r)},t.prototype.navigateBack=function(){this.isExplicitNavigationBack=!0,this.history.navigateBack()},t.prototype.createChild=function(e){var r=new t(e||this.container.createChild(),this.history);return r.parent=this,r},t.prototype.generate=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r={});var n="childRoute"in e?this._childRecognizer:this._recognizer;if(!n.hasRoute(t)){if(this.parent)return this.parent.generate(t,e,r);throw new Error("A route with name '"+t+"' could not be found. Check that `name: '"+t+"'` was specified in the route's config.")}var i=S(n.generate(t,e),this.baseUrl,this.history._hasPushState,r.absolute);return r.absolute?""+this.history.getAbsoluteRoot()+i:i},t.prototype.createNavModel=function(t){var e=new _(this,"href"in t?t.href:t.route);return e.title=t.title,e.order=t.nav,e.href=t.href,e.settings=t.settings,e.config=t,e},t.prototype.addRoute=function(t,e){if(Array.isArray(t.route))R(t).forEach(this.addRoute.bind(this));else{C(t),"viewPorts"in t||t.navigationStrategy||(t.viewPorts={default:{moduleId:t.moduleId,view:t.view}}),e||(e=this.createNavModel(t)),this.routes.push(t);var r=t.route;"/"===r.charAt(0)&&(r=r.substr(1));var n=!0===t.caseSensitive,i=this._recognizer.add({path:r,handler:t,caseSensitive:n});if(r){var o=t.settings;delete t.settings;var a=JSON.parse(JSON.stringify(t));t.settings=o,a.route=r+"/*childRoute",a.hasChildRouter=!0,this._childRecognizer.add({path:a.route,handler:a,caseSensitive:n}),a.navModel=e,a.settings=t.settings,a.navigationStrategy=t.navigationStrategy}t.navModel=e;var u=this.navigation;if((e.order||0===e.order)&&-1===u.indexOf(e)){if(!e.href&&""!==e.href&&(i.types.dynamics||i.types.stars))throw new Error('Invalid route config for "'+t.route+'" : dynamic routes must specify an "href:" to be included in the navigation model.');"number"!=typeof e.order&&(e.order=++this._fallbackOrder),u.push(e),u.sort((function(t,e){return t.order-e.order}))}}},t.prototype.hasRoute=function(t){return!!(this._recognizer.hasRoute(t)||this.parent&&this.parent.hasRoute(t))},t.prototype.hasOwnRoute=function(t){return this._recognizer.hasRoute(t)},t.prototype.handleUnknownRoutes=function(t){var e=this;if(!t)throw new Error("Invalid unknown route handler");this.catchAllHandler=function(r){return e._createRouteConfig(t,r).then((function(t){return r.config=t,r}))}},t.prototype.updateTitle=function(){var t=this.parent;if(t)return t.updateTitle();var e=this.currentInstruction;e&&e._updateTitle()},t.prototype.refreshNavigation=function(){for(var t=this.navigation,e=0,r=t.length;e<r;e++){var n=t[e];n.config.href?n.href=P(n.config.href,this.history._hasPushState):n.href=S(n.relativeHref,this.baseUrl,this.history._hasPushState)}},t.prototype.useViewPortDefaults=function(t){var e=t;for(var r in e){var n=e[r];this.viewPortDefaults[r]={moduleId:n.moduleId}}},t.prototype._refreshBaseUrl=function(){var t=this.parent;t&&(this.baseUrl=E(t,t.currentInstruction))},t.prototype._createNavigationInstruction=function(t,e){void 0===t&&(t=""),void 0===e&&(e=null);var r=t,n="",i=t.indexOf("?");-1!==i&&(r=t.substr(0,i),n=t.substr(i+1));var o=this._recognizer.recognize(t);o&&o.length||(o=this._childRecognizer.recognize(t));var a,u={fragment:r,queryString:n,config:null,parentInstruction:e,previousInstruction:this.currentInstruction,router:this,options:{compareQueryParams:this.options.compareQueryParams}};if(o&&o.length){var s=o[0],c=new b(Object.assign({},u,{params:s.params,queryParams:s.queryParams||o.queryParams,config:s.config||s.handler}));a="function"==typeof s.handler?j(c,s.handler,s):s.handler&&"function"==typeof s.handler.navigationStrategy?j(c,s.handler.navigationStrategy,s.handler):Promise.resolve(c)}else if(this.catchAllHandler)c=new b(Object.assign({},u,{params:{path:r},queryParams:o?o.queryParams:{},config:null})),a=j(c,this.catchAllHandler);else if(this.parent){var f=this._parentCatchAllHandler(this.parent);if(f){var l=this._findParentInstructionFromRouter(f,e);c=new b(Object.assign({},u,{params:{path:r},queryParams:o?o.queryParams:{},router:f,parentInstruction:l,parentCatchHandler:!0,config:null})),a=j(c,f.catchAllHandler)}}return a&&e&&(this.baseUrl=E(this.parent,e)),a||Promise.reject(new Error("Route not found: "+t))},t.prototype._findParentInstructionFromRouter=function(t,e){return e.router===t?(e.fragment=t.baseUrl,e):e.parentInstruction?this._findParentInstructionFromRouter(t,e.parentInstruction):void 0},t.prototype._parentCatchAllHandler=function(t){return t.catchAllHandler?t:!!t.parent&&this._parentCatchAllHandler(t.parent)},t.prototype._createRouteConfig=function(t,e){var r=this;return Promise.resolve(t).then((function(t){return"string"==typeof t?{moduleId:t}:"function"==typeof t?t(e):t})).then((function(t){return"string"==typeof t?{moduleId:t}:t})).then((function(t){return t.route=e.params.path,C(t),t.navModel||(t.navModel=r.createNavModel(t)),t}))},t}(),E=function(t,e){return""+(t.baseUrl||"")+(e.getBaseUrl()||"")},C=function(t){if("object"!=typeof t)throw new Error("Invalid Route Config");if("string"!=typeof t.route){var e=t.name||"(no name)";throw new Error('Invalid Route Config for "'+e+'": You must specify a "route:" pattern.')}if(!("redirect"in t||t.moduleId||t.navigationStrategy||t.viewPorts))throw new Error('Invalid Route Config for "'+t.route+'": You must specify a "moduleId:", "redirect:", "navigationStrategy:", or "viewPorts:".')},j=function(t,e,r){return Promise.resolve(e.call(r,t)).then((function(){return"viewPorts"in t.config||(t.config.viewPorts={default:{moduleId:t.config.moduleId}}),t}))},k=function(t,e){return function(t){return Promise.resolve({status:e,output:t,completed:"completed"===e})}},x=function(){function t(){this.steps=[]}return t.prototype.addStep=function(t){var e;if("function"==typeof t)e=t;else{if("function"==typeof t.getSteps){for(var r=t.getSteps(),n=0,i=r.length;n<i;n++)this.addStep(r[n]);return this}e=t.run.bind(t)}return this.steps.push(e),this},t.prototype.run=function(t){var e=function(t,e){var r=-1,n=function(){if(!(++r<e.length))return n.complete();var i=e[r];try{return i(t,n)}catch(t){return n.reject(t)}};return n.complete=k(0,"completed"),n.cancel=k(0,"canceled"),n.reject=k(0,"rejected"),n}(t,this.steps);return e()},t}();function M(t){return t&&"function"==typeof t.navigate}var T=function(){function t(t,e){void 0===e&&(e={}),this.url=t,this.options=Object.assign({trigger:!0,replace:!0},e),this.shouldContinueProcessing=!1}return t.prototype.setRouter=function(t){this.router=t},t.prototype.navigate=function(t){(this.options.useAppRouter?t:this.router||t).navigate(this.url,this.options)},t}();function q(t,e){var r=t.config;if("redirect"in r)return F(t);var n=t.previousInstruction,i=t.router.viewPortDefaults;if(n)return z(t,n,i,e);var o={},a=r.viewPorts;for(var u in a){var s=a[u];null===s.moduleId&&u in i&&(s=i[u]),o[u]={name:u,strategy:"replace",config:s}}return Promise.resolve(o)}!function(){function t(t,e,r){void 0===e&&(e={}),void 0===r&&(r={}),this.route=t,this.params=e,this.options=Object.assign({trigger:!0,replace:!0},r),this.shouldContinueProcessing=!1}t.prototype.setRouter=function(t){this.router=t},t.prototype.navigate=function(t){(this.options.useAppRouter?t:this.router||t).navigateToRoute(this.route,this.params,this.options)}}();var U,F=function(t){var e=t.config,r=t.router;return r._createNavigationInstruction(e.redirect).then((function(e){var n={},i=t.params,o=e.params;for(var a in o){var u=o[a];"string"==typeof u&&":"===u[0]?(u=u.slice(1))in i&&(n[a]=i[u]):n[a]=o[a]}var s=r.generate(e.config,n,t.options);for(var a in i)s=s.replace(":"+a,i[a]);var c=t.queryString;return c&&(s+="?"+c),Promise.resolve(new T(s))}))},z=function(t,e,r,n){var i={},o=t.config,a=D(e,t),u=[],s=e.viewPortInstructions,c=function(e){var c=s[e],f=c.component,l=o.viewPorts,h=e in l?l[e]:c;null===h.moduleId&&e in r&&(h=r[e]);var p=W(t,c,h,a,n),v=i[e]={name:e,config:h,prevComponent:f,prevModuleId:c.moduleId,strategy:p};if("replace"!==p&&c.childRouter){var d=t.getWildcardPath(),g=c.childRouter._createNavigationInstruction(d,t).then((function(t){return v.childNavigationInstruction=t,q(t,"invoke-lifecycle"===v.strategy).then((function(e){return e instanceof T?Promise.reject(e):(t.plan=e,null)}))}));u.push(g)}};for(var f in s)c(f);return Promise.all(u).then((function(){return i}))},W=function(t,e,r,n,i){var o=t.config,a=e.component.viewModel;return e.moduleId!==r.moduleId?"replace":"determineActivationStrategy"in a?a.determineActivationStrategy.apply(a,t.lifecycleArgs):o.activationStrategy?o.activationStrategy:n||i?"invoke-lifecycle":"no-change"},D=function(t,e){var r=t.params,n=e.params,i=e.config.hasChildRouter?e.getWildCardName():null;for(var o in n)if(o!==i&&r[o]!==n[o])return!0;for(var o in r)if(o!==i&&r[o]!==n[o])return!0;if(!e.options.compareQueryParams)return!1;var a=t.queryParams,u=e.queryParams;for(var o in u)if(a[o]!==u[o])return!0;for(var o in a)if(a[o]!==u[o])return!0;return!1},H=function(){function t(){}return t.prototype.run=function(t,e){return q(t).then((function(r){return r instanceof T?e.cancel(r):(t.plan=r,e())})).catch(e.cancel)},t}(),V=function(t,e){var r=B(e).map((function(e){return L(t,e.navigationInstruction,e.viewPortPlan)}));return Promise.all(r)},B=function(t,e){void 0===e&&(e=[]);var r=t.plan;for(var n in r){var i=r[n],o=i.childNavigationInstruction;if("replace"===i.strategy)e.push({viewPortPlan:i,navigationInstruction:t}),o&&B(o,e);else{var a=t.addViewPortInstruction({name:n,strategy:i.strategy,moduleId:i.prevModuleId,component:i.prevComponent});o&&(a.childNavigationInstruction=o,B(o,e))}}return e},L=function(t,e,r){var n=r.config,i=n?n.moduleId:null;return $(t,e,n).then((function(n){var o=e.addViewPortInstruction({name:r.name,strategy:r.strategy,moduleId:i,component:n}),a=n.childRouter;if(a){var u=e.getWildcardPath();return a._createNavigationInstruction(u,e).then((function(e){return r.childNavigationInstruction=e,q(e).then((function(r){return r instanceof T?Promise.reject(r):(e.plan=r,o.childNavigationInstruction=e,V(t,e))}))}))}}))},$=function(t,e,r){var n=e.router,i=e.lifecycleArgs;return Promise.resolve().then((function(){return t.loadRoute(n,r,e)})).then((function(t){var e=t.viewModel,o=t.childContainer;if(t.router=n,t.config=r,"configureRouter"in e){var a=o.getChildRouter();return t.childRouter=a,a.configure((function(t){return e.configureRouter(t,a,i[0],i[1],i[2])})).then((function(){return t}))}return t}))},J=function(){function t(){}return t.prototype.loadRoute=function(t,e,r){throw new Error('Route loaders must implement "loadRoute(router, config, navigationInstruction)".')},t}(),Q=function(){function t(t){this.routeLoader=t}return t.inject=function(){return[J]},t.prototype.run=function(t,e){return V(this.routeLoader,t).then(e,e.cancel)},t}(),Y=function(){function t(){}return t.prototype.run=function(t,e){return t._commitChanges(!0).then((function(){return t._updateTitle(),e()}))},t}();!function(t){t.NoChange="no-change",t.InvokeLifecycle="invoke-lifecycle",t.Replace="replace"}(U||(U={}));var K,G,X,Z="invoke-lifecycle",tt="replace",et=function(t,e,r,n){var i=t.plan,o=rt(i,e),a=o.length;function u(t){return n||at(t)?s():r.cancel(t)}function s(){if(a--)try{var n=o[a][e](t);return st(n,u,r.cancel)}catch(t){return r.cancel(t)}return t.router.couldDeactivate=!0,r()}return s()},rt=function(t,e,r){for(var n in void 0===r&&(r=[]),t){var i=t[n],o=i.prevComponent;if((i.strategy===Z||i.strategy===tt)&&o){var a=o.viewModel;e in a&&r.push(a)}i.strategy===tt&&o?nt(o,e,r):i.childNavigationInstruction&&rt(i.childNavigationInstruction.plan,e,r)}return r},nt=function(t,e,r){var n=t.childRouter;if(n&&n.currentInstruction){var i=n.currentInstruction.viewPortInstructions;for(var o in i){var a=i[o].component,u=a.viewModel;e in u&&r.push(u),nt(a,e,r)}}},it=function(t,e,r,n){var i=ot(t,e),o=i.length,a=-1;return function t(){var u;if(++a<o)try{var s=i[a],c=(u=s.viewModel)[e].apply(u,s.lifecycleArgs);return st(c,(function(e){return function(e,i){return n||at(e,i)?t():r.cancel(e)}(e,s.router)}),r.cancel)}catch(t){return r.cancel(t)}return r()}()},ot=function(t,e,r,n){void 0===r&&(r=[]);var i=t.plan;return Object.keys(i).forEach((function(o){var a=i[o],u=t.viewPortInstructions[o],s=u.component,c=s.viewModel;a.strategy!==Z&&a.strategy!==tt||!(e in c)||r.push({viewModel:c,lifecycleArgs:u.lifecycleArgs,router:n});var f=a.childNavigationInstruction;f&&ot(f,e,r,s.childRouter||n)})),r},at=function(t,e){return!(t instanceof Error)&&(M(t)?("function"==typeof t.setRouter&&t.setRouter(e),!!t.shouldContinueProcessing):void 0===t||t)},ut=function(){function t(t){this._subscribed=!0,this._subscription=t(this),this._subscribed||this.unsubscribe()}return Object.defineProperty(t.prototype,"subscribed",{get:function(){return this._subscribed},enumerable:!0,configurable:!0}),t.prototype.unsubscribe=function(){this._subscribed&&this._subscription&&this._subscription.unsubscribe(),this._subscribed=!1},t}(),st=function(t,e,r){if(t&&"function"==typeof t.then)return Promise.resolve(t).then(e).catch(r);if(t&&"function"==typeof t.subscribe){var n=t;return new ut((function(i){return n.subscribe({next:function(){i.subscribed&&(i.unsubscribe(),e(t))},error:function(t){i.subscribed&&(i.unsubscribe(),r(t))},complete:function(){i.subscribed&&(i.unsubscribe(),e(t))}})}))}try{return e(t)}catch(t){return r(t)}},ct=function(){function t(){}return t.prototype.run=function(t,e){return et(t,"canDeactivate",e)},t}(),ft=function(){function t(){}return t.prototype.run=function(t,e){return it(t,"canActivate",e)},t}(),lt=function(){function t(){}return t.prototype.run=function(t,e){return et(t,"deactivate",e,!0)},t}(),ht=function(){function t(){}return t.prototype.run=function(t,e){return it(t,"activate",e,!0)},t}(),pt=function(){function t(t,e,r){this.steps=[],this.container=t,this.slotName=e,this.slotAlias=r}return t.prototype.getSteps=function(){var t=this;return this.steps.map((function(e){return t.container.get(e)}))},t}(),vt=function(){function t(t){this.container=t,this.steps=[H,ct,Q,dt(t,"authorize"),ft,dt(t,"preActivate","modelbind"),lt,ht,dt(t,"preRender","precommit"),Y,dt(t,"postRender","postcomplete")]}return t.inject=function(){return[i.W2]},t.prototype.createPipeline=function(t){var e=this;void 0===t&&(t=!0);var r=new x;return this.steps.forEach((function(n){(t||n!==ct)&&r.addStep(e.container.get(n))})),r},t.prototype._findStep=function(t){return this.steps.find((function(e){return e.slotName===t||e.slotAlias===t}))},t.prototype.addStep=function(t,e){var r=this._findStep(t);if(!r)throw new Error("Invalid pipeline slot name: "+t+".");var n=r.steps;n.includes(e)||n.push(e)},t.prototype.removeStep=function(t,e){var r=this._findStep(t);if(r){var n=r.steps;n.splice(n.indexOf(e),1)}},t.prototype._clearSteps=function(t){void 0===t&&(t="");var e=this._findStep(t);e&&(e.steps=[])},t.prototype.reset=function(){this._clearSteps("authorize"),this._clearSteps("preActivate"),this._clearSteps("preRender"),this._clearSteps("postRender")},t}(),dt=function(t,e,r){return new pt(t,e,r)},gt=(0,n.jl)("app-router"),yt=function(t){function e(e,r,n,i){var o=t.call(this,e,r)||this;return o.pipelineProvider=n,o.events=i,o}return function(t,e){function r(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.inject=function(){return[i.W2,o.A,vt,y.h]},e.prototype.reset=function(){t.prototype.reset.call(this),this.maxInstructionCount=10,this._queue?this._queue.length=0:this._queue=[]},e.prototype.loadUrl=function(t){var e=this;return this._createNavigationInstruction(t).then((function(t){return e._queueInstruction(t)})).catch((function(t){gt.error(t),wt(e)}))},e.prototype.registerViewPort=function(e,r){var n=this,i=e;if(t.prototype.registerViewPort.call(this,i,r),this.isActive)this._dequeueInstruction();else{var o=this._findViewModel(i);if("configureRouter"in o){if(!this.isConfigured){var a=this._resolveConfiguredPromise;return this._resolveConfiguredPromise=function(){},this.configure((function(t){return Promise.resolve(o.configureRouter(t,n)).then((function(){return t}))})).then((function(){n.activate(),a()}))}}else this.activate()}return Promise.resolve()},e.prototype.activate=function(t){this.isActive||(this.isActive=!0,this.options=Object.assign({routeHandler:this.loadUrl.bind(this)},this.options,t),this.history.activate(this.options),this._dequeueInstruction())},e.prototype.deactivate=function(){this.isActive=!1,this.history.deactivate()},e.prototype._queueInstruction=function(t){var e=this;return new Promise((function(r){t.resolve=r,e._queue.unshift(t),e._dequeueInstruction()}))},e.prototype._dequeueInstruction=function(t){var e=this;return void 0===t&&(t=0),Promise.resolve().then((function(){if(!e.isNavigating||t){var r=e._queue.shift();if(e._queue.length=0,r){e.isNavigating=!0;var n=e.history.getState("NavigationTracker"),i=e.currentNavigationTracker;n||i?n?i?i<n?e.isNavigatingForward=!0:i>n&&(e.isNavigatingBack=!0):e.isNavigatingRefresh=!0:e.isNavigatingNew=!0:(e.isNavigatingFirst=!0,e.isNavigatingNew=!0),n||(n=Date.now(),e.history.setState("NavigationTracker",n)),e.currentNavigationTracker=n,r.previousInstruction=e.currentInstruction;var o=e.maxInstructionCount;if(t){if(t===o-1)return gt.error(t+1+" navigation instructions have been attempted without success. Restoring last known good location."),wt(e),e._dequeueInstruction(t+1);if(t>o)throw new Error("Maximum navigation attempts exceeded. Giving up.")}else e.events.publish("router:navigation:processing",{instruction:r});return e.pipelineProvider.createPipeline(!e.couldDeactivate).run(r).then((function(n){return mt(r,n,t,e)})).catch((function(t){return{output:t instanceof Error?t:new Error(t)}})).then((function(n){return bt(r,n,!!t,e)}))}}}))},e.prototype._findViewModel=function(t){if(this.container.viewModel)return this.container.viewModel;if(t.container)for(var e=t.container;e;){if(e.viewModel)return this.container.viewModel=e.viewModel,e.viewModel;e=e.parent}},e}(N),mt=function(t,e,r,n){e&&"completed"in e&&"output"in e||((e=e||{}).output=new Error("Expected router pipeline to return a navigation result, but got ["+JSON.stringify(e)+"] instead."));var i=null,o=null;return M(e.output)?o=e.output.navigate(n):(i=e,e.completed||(e.output instanceof Error&&gt.error(e.output.toString()),wt(n))),Promise.resolve(o).then((function(t){return n._dequeueInstruction(r+1)})).then((function(t){return i||t||e}))},bt=function(t,e,r,n){t.resolve(e);var i=n.events,o={instruction:t,result:e};if(r)i.publish("router:navigation:child:complete",o);else{n.isNavigating=!1,n.isExplicitNavigation=!1,n.isExplicitNavigationBack=!1,n.isNavigatingFirst=!1,n.isNavigatingNew=!1,n.isNavigatingRefresh=!1,n.isNavigatingForward=!1,n.isNavigatingBack=!1,n.couldDeactivate=!1;var a=void 0;if(e.output instanceof Error)a="router:navigation:error";else if(e.completed){var u=t.queryString?"?"+t.queryString:"";n.history.previousLocation=t.fragment+u,a="router:navigation:success"}else a="router:navigation:canceled";i.publish(a,o),i.publish("router:navigation:complete",o)}return e},wt=function(t){var e=t.history.previousLocation;e?t.navigate(e,{trigger:!1,replace:!0}):t.fallbackRoute?t.navigate(t.fallbackRoute,{trigger:!0,replace:!0}):gt.error("Router navigation failed, and no previous location or fallbackRoute could be restored.")};!function(t){t.Completed="completed",t.Canceled="canceled",t.Rejected="rejected",t.Running="running"}(K||(K={})),function(t){t.Processing="router:navigation:processing",t.Error="router:navigation:error",t.Canceled="router:navigation:canceled",t.Complete="router:navigation:complete",t.Success="router:navigation:success",t.ChildComplete="router:navigation:child:complete"}(G||(G={})),function(t){t.Authorize="authorize",t.PreActivate="preActivate",t.PreRender="preRender",t.PostRender="postRender"}(X||(X={}))}}]);